<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF‑8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Servidores – Lily Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f5f7fa;
      --surface: #fff;
      --accent: #0E65E3;
      --text: #43484A;
      --muted: #A0B4C1;
      --radius: 12px;
      --shadow: rgba(0,0,0,0.05);
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      background: var(--bg);
      font-family:'Inter',sans-serif;
      color: var(--text);
      min-height:100vh;
      padding:2rem;
    }
    .card {
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: 0 4px 20px var(--shadow);
      max-width:600px; width:100%; margin:0 auto;
      padding:2rem;
    }
    .user {
      display:flex; align-items:center; gap:1rem; margin-bottom:1.5rem;
    }
    .user img {
      width:56px; height:56px; border-radius:50%;
      border:2px solid var(--accent);
    }
    .guilds {
      list-style:none; padding:0;
    }
    .guilds li {
      display:flex; align-items:center;
      justify-content:space-between;
      padding:1rem; margin-top:1rem;
      background:var(--bg); border-radius:var(--radius);
      cursor:pointer;
      transition: background 0.2s;
    }
    .guilds li:hover {
      background:var(--accent); color:#fff;
    }
    .guilds li img {
      width:40px; height:40px; border-radius:50%;
      background:#ddd;
    }
    .name { flex:1; margin-left:1rem; font-weight:600; text-align:left; }
    .status {
      padding:0.25rem 0.5rem;
      border-radius:6px;
      font-size:0.9rem;
      font-weight:600;
    }
    .present { background:#01902C; color:#fff; }
    .absent { background:#f04747; color:#fff; }
  </style>
</head>
<body>
  <div class="card">
    <div id="root">
      <p style="text-align:center; color:var(--muted)">Carregando...</p>
    </div>
  </div>
  <script>
    const qp = k=>new URLSearchParams(location.search).get(k);
    const root = document.getElementById('root');

    async function init() {
      const code = qp('code');
      if(!code) return root.innerHTML = '<p style="color:red; text-align:center;">Código ausente.</p>';
      try {
        const res = await fetch(`https://fps.ms/api/callback?code=${code}`);
        const data = await res.json();
        render(data);
      } catch {
        root.innerHTML = '<p style="color:red; text-align:center;">Falha ao carregar dados.</p>';
      }
    }

    function render({user, guilds}) {
      root.innerHTML = '';
      const userEl = document.createElement('div');
      userEl.className = 'user';
      userEl.innerHTML = `
        <img src="${user.avatarUrl}" alt="">
        <div>
          <h2>${user.username}</h2>
          <p style="color:var(--muted);">ID: ${user.id}</p>
        </div>`;
      root.appendChild(userEl);

      const ul = document.createElement('ul');
      ul.className = 'guilds';
      if(guilds.length === 0) {
        ul.innerHTML = `<li>Nenhume servidor disponível.</li>`;
      } else {
        guilds.forEach(g=>{
          const li = document.createElement('li');
          li.onclick = ()=>location.href = `/guild.html?id=${g.id}`;
          li.innerHTML = `
            <img src="https://cdn.discordapp.com/icons/${g.id}/${g.icon}.png" alt="">
            <span class="name">${g.name}</span>
            <span class="status ${g.hasBot?'present':'absent'}">
              ${g.hasBot?'Bot presente':'Bot ausente'}
            </span>`;
          ul.appendChild(li);
        });
      }
      root.appendChild(ul);
    }

    init();
  </script>
</body>
</html>
