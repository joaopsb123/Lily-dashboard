<!DOCTYPE html>
<html lang="pt-BR">
<head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Processando...</title></head>
<body style="font-family:sans-serif;background:#121212;color:#fff;display:flex;justify-content:center;align-items:center;height:100vh;text-align:center;">
  <div id="msg">Processando login...</div>
<script>
  (async ()=>{
    const params = new URLSearchParams(location.search);
    const code = params.get('code');
    if (!code) return document.getElementById('msg').textContent = 'Erro: código não encontrado';
    try {
      const res = await fetch(`/api/callback?code=${code}`);
      if(!res.ok) throw await res.json();
      const data = await res.json();
      localStorage.setItem('lilyData', JSON.stringify(data));
      location.href = '/guild.html';
    } catch (err) {
      console.error(err);
      document.getElementById('msg').textContent = 'Falha ao obter dados. Tente novamente.';
    }
  })();
</script>
</body>
</html>
